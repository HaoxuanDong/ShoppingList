<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <title>JS exercise for a Cart</title>
  <style>
    * {
    margin:0;
    padding:0;
    box-sizing: border-box;
    }

    body {
        font-family: Arial, sans-serif; 
        padding: 20px; 
    }

    .product-list {
        /*  display: flex;
        gap: 20px;
        flex-wrap: wrap; */
        display: grid;
        gap: 1.5rem;
        grid-template-columns:repeat(auto-fit,minmax(250px, 1fr));
    }
    .card {
      /* width: 200px; */
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      height: 200px;
      background: #f9f9f9;
      border-radius: 12px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
      text-align: center;
    }
    .card h3{
        margin-bottom: 1rem;
    }
   
    .card button {
      margin-top: 1rem;
      padding: 5px 10px;
      border: none;
      background: #007bff;
      color: white;
      border-radius: 5px;
      cursor: pointer;
    }

    .cart {
      margin-top: 2rem;
    }
    .cart-items {
      display: none;
      border: 1px solid #ccc;
      padding: 1rem;
      border-radius: 10px;
      margin-top: 10px;
    }
    .cart-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin: 5px 0;
    }
    .cart-item button {
      padding: 3px 7px;
      margin-left: 5px;
    }
    .btn{
        padding-right: 0.5rem;
        border-radius: 4px;
    }
    #cartMessage{
      color:red;
      font-weight:bold;
      margin-top:10px;
    }
    .searchResult{
      display: none;
    }
    
  </style>
</head>
<body>

<h2>Product List</h2>
<div class="product-list" id="productList"></div>

<div class="cart">
  <button class="btn" onclick="toggleCart()">üõí Your Cart</button>
  <input type="text" id="searchInput" placeholder="ËæìÂÖ•ÂïÜÂìÅÂêçÊàñIDÊü•ËØ¢">
  <button class="btn"onclick="searchCart()">Search your Cart</button>
  <div id="searchResult"></div>
  <div class="cart-items" id="cartItems"></div>
  <div id="cartMessage" ></div>
</div>

<script>
  const products = [
    { id: 1, name: "apple", price: 5 },
    { id: 2, name: "banana", price: 3 },
    { id: 3, name: "orange", price: 4 },
  ];

  const cart = [];

  // create products cards
  const productList = document.getElementById("productList");
  products.forEach(product => {
    const card = document.createElement("div");
    card.className = "card";
    card.innerHTML = `
      <h3>${product.name}</h3>
      <p>Price: Ôø•${product.price}</p>
      <button  onclick="addToCart(${product.id})">Add to cart</button>
    `;
    productList.appendChild(card);
  });
    function getTotalQuantity() {
      let total = 0;
      cart.forEach(item => {
          total += item.quantity;
      });
      return total;
    }

  function addToCart(productId) {
    let totalQuantity = getTotalQuantity();

    if (totalQuantity >= 5) {
        document.getElementById("cartMessage").textContent = "‚ùå Cart limit reachedÔºÅCannot add more than 5 items.";
        console.log("Cart is fullÔºÅ");
        return;
    }
    const product = products.find(p => p.id === productId);
    const existing = cart.find(item => item.id === productId);
    if (existing) {
        document.getElementById("cartMessage").textContent = "";
        existing.quantity++;
        console.log(`${existing.name} adds to cart!ÔºåquantityÔºö${existing.quantity}`)
    } else {
        document.getElementById("cartMessage").textContent = "";
        cart.push({ ...product, quantity: 1 });
        console.log(`${cart[cart.length - 1].name} adds to cart!ÔºåquantityÔºö${cart[cart.length - 1].quantity}`);
    }
    renderCart();
  }

  function renderCart() {
    const cartItems = document.getElementById("cartItems");
    cartItems.innerHTML = "";
    let total = 0;

    cart.forEach(item => {
      total += item.price * item.quantity;
      const div = document.createElement("div");
      div.className = "cart-item";
      div.innerHTML = `
        ${item.name} - Ôø•${item.price} √ó ${item.quantity}
        <div>
          <button onclick="updateQuantity(${item.id}, -1)">‚ûñ</button>
          <button onclick="updateQuantity(${item.id}, 1)">‚ûï</button>
        </div>
      `;
      cartItems.appendChild(div);
    });

    const totalDiv = document.createElement("div");
    totalDiv.innerHTML = `<strong>Total amount: Ôø•${total}</strong>`;
    cartItems.appendChild(totalDiv);
  }

  function updateQuantity(productId, change) {
    let totalQuantity = getTotalQuantity();

    if (totalQuantity >= 5 && change=== 1) {
        document.getElementById("cartMessage").textContent = "‚ùå Cart limit reachedÔºÅCannot add more than 5 items.";
        console.log("Cart is fullÔºÅ");
        return;
    }
    const item = cart.find(p => p.id === productId);
    if (item) {
      item.quantity += change;
      if(change === 1){
        console.log(`${item.name} adds to cart!ÔºåquantityÔºö${item.quantity}`)
      }else{
        console.log(`delete one ${item.name} from cartÔºåquantityÔºö${item.quantity}`)
      }
      if (item.quantity <= 0) {
        const index = cart.findIndex(p => p.id === productId);
        cart.splice(index, 1);
      }
      renderCart();
      document.getElementById("cartMessage").textContent = "";
    }
  }
  function searchCart() {
    const searchResult = document.getElementById("searchResult");
    searchResult.innerHTML="";
    const div = document.createElement("div");
    div.className = "show-result";
    div.innerHTML="";
    const keyword = document.getElementById("searchInput").value.trim();
    if (!keyword) {
    console.log(`please enter items name or ID!`)
    div.innerHTML=`please enter items name or ID!`;
      searchResult.appendChild(div);
      return;
    }

    const foundItem = cart.find(item => 
      item.name.includes(keyword) || item.id.toString() === keyword
    );

    if (foundItem) {
      console.log(`found itemÔºö${foundItem.name}, quantityÔºö${foundItem.quantity}, Single priceÔºöÔø•${foundItem.price}`);
      div.innerHTML=`found itemÔºö${foundItem.name}, quantityÔºö${foundItem.quantity}, Single priceÔºöÔø•${foundItem.price}`
      searchResult.appendChild(div);
    } else {
      console.log("no such item in your cartÔºÅ");
      div.innerHTML=`no such item in your cartÔºÅ`;
      searchResult.appendChild(div);
    }
  }
   


  function toggleCart() {
    const cartItems = document.getElementById("cartItems");
    cartItems.style.display = cartItems.style.display === "block" ? "none" : "block";
  }
</script>

</body>
</html>
